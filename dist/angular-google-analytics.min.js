/**
 * Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.0.1 - 2013-12-11
 * @link http://revolunet.com.github.com/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-google-analytics",[]).provider("Analytics",function(){var a,b,c,d,e=!1,f=!0,g="",h=!1,i="$routeChangeSuccess",j="auto",k=!1,l=!1;this._logs=[],this.setAccount=function(b){return a=b,!0},this.trackPages=function(a){return f=a,!0},this.trackPrefix=function(a){return g=a,!0},this.setDomainName=function(a){return b=a,!0},this.useAnalytics=function(a){return h=!!a,!0},this.useEnhancedLinkAttribution=function(a){return l=!!a,!0},this.setPageEvent=function(a){return i=a,!0},this.setCookieConfig=function(a){return j=a,!0},this.useECommerce=function(a){return k=!!a,!0},this.setRemoveRegExp=function(a){return a instanceof RegExp?(c=a,!0):!1},this.setExperimentId=function(a){return d=a,!0},this.$get=["$document","$rootScope","$location","$window",function(m,n,o,p){function q(){a&&(p._gaq=[],p._gaq.push(["_setAccount",a]),l&&p._gaq.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]),f&&(c?p._gaq.push(["_trackPageview",s()]):p._gaq.push(["_trackPageview"])),b&&p._gaq.push(["_setDomainName",b]),function(){var a=m[0],b=a.createElement("script");b.type="text/javascript",b.async=!0,b.src=("https:"===a.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var c=a.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}(),e=!0)}function r(){if(!a)return console.warn("No account id set for Analytics.js");if(function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),p.ga("create",a,j),f&&p.ga("send","pageview",s()),p.ga&&(k&&p.ga("require","ecommerce","ecommerce.js"),l&&p.ga("require","linkid","linkid.js"),d)){var b=document.createElement("script"),c=document.getElementsByTagName("script")[0];b.src="//www.google-analytics.com/cx/api.js?experiment="+d,c.parentNode.insertBefore(b,c)}}var s=function(){var a=o.path();return c?a.replace(c,""):a};this._log=function(){this._logs.push(arguments)},this._trackPage=function(a){f&&!h&&p._gaq?(p._gaq.push(["_trackPageview",g+a]),this._log("_trackPageview",arguments)):f&&h&&p.ga&&(p.ga("send","pageview",g+a),this._log("pageview",arguments))},this._trackEvent=function(a,b,c,d){!h&&p._gaq?(p._gaq.push(["_trackEvent",a,b,c,d]),this._log("trackEvent",arguments)):p.ga&&(p.ga("send","event",a,b,c,d),this._log("event",arguments))},this._addTrans=function(a,b,c,d,e,f,g,i,j){!h&&p._gaq?(p._gaq.push(["_addTrans",a,b,c,d,e,f,g,i]),this._log("_addTrans",arguments)):p.ga&&(k?(p.ga("ecommerce:addTransaction",{id:a,affiliation:b,revenue:c,tax:d,shipping:e,currency:j||"USD"}),this._log("ecommerce:addTransaction",arguments)):console.warn("ecommerce no set. Use AnalyticsProvider.setECommerce(true);"))},this._addItem=function(a,b,c,d,e,f){!h&&p._gaq?(p._gaq.push(["_addItem",a,b,c,d,e,f]),this._log("_addItem",arguments)):p.ga&&(p.ga("ecommerce:addItem",{id:a,name:c,sku:b,category:d,price:e,quantity:f}),this._log("ecommerce:addItem",arguments))},this._trackTrans=function(){!h&&p._gaq?(p._gaq.push(["_trackTrans"]),this._log("_trackTrans",arguments)):p.ga&&(p.ga("ecommerce:send"),this._log("ecommerce:send",arguments))},this._clearTrans=function(){p.ga&&(p.ga("ecommerce:clear"),this._log("ecommerce:clear",arguments))},this._send=function(a){p.ga&&(p.ga("send",a),this._log("send",a))},h?r():q();var t=this;return f&&n.$on(i,function(){t._trackPage(s())}),{_logs:t._logs,cookieConfig:j,ecommerce:k,enhancedLinkAttribution:l,getUrl:s,experimentId:d,trackPage:function(a){t._trackPage(a)},trackEvent:function(a,b,c,d){t._trackEvent(a,b,c,d)},addTrans:function(a,b,c,d,e,f,g,h){t._addTrans(a,b,c,d,e,f,g,h)},addItem:function(a,b,c,d,e,f){t._addItem(a,b,c,d,e,f)},trackTrans:function(){t._trackTrans()},clearTrans:function(){t._clearTrans()},send:function(a){t._send(a)}}}]});